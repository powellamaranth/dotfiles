#!/usr/bin/env bash

# install asdf
rm -fr $HOME/.asdf
git clone https://github.com/asdf-vm/asdf.git $HOME/.asdf --branch v0.9.0

# checkout
rm -fr $HOME/.dotfiles
git clone "https://github.com/danielgatis/dotfiles.git" "$HOME/.dotfiles"

# link dotfiles to home
ln -fs $HOME/.dotfiles/home/.alacritty.yml $HOME/.alacritty.yml
ln -fs $HOME/.dotfiles/home/.asdfrc $HOME/.asdfrc
ln -fs $HOME/.dotfiles/home/.Brewfile $HOME/.Brewfile
ln -fs $HOME/.dotfiles/home/.editorconfig $HOME/.editorconfig
ln -fs $HOME/.dotfiles/home/.gitconfig $HOME/.gitconfig
ln -fs $HOME/.dotfiles/home/.gitignore $HOME/.gitignore
ln -fs $HOME/.dotfiles/home/.zshrc $HOME/.zshrc

mkdir -p $HOME/.dotfiles/home/.config/hammerspoon
ln -fs $HOME/.dotfiles/home/.config/hammerspoon/init.lua $HOME/.config/hammerspoon/init.lua

mkdir -p $HOME/.dotfiles/home/.config/nvim
ln -fs $HOME/.dotfiles/home/.config/nvim/init.lua $HOME/.config/nvim/init.lua

# install homewbrew and bundle
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
brew bundle --global --force --no-lock || true

# install nvim plugins
rm -fr $HOME/.config/nvim/plugin/packer_compiled.lua
nvim --headless -c 'autocmd User PackerComplete quitall' -c 'PackerSync'
